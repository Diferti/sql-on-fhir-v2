{
  "title": "union",
  "resources": [
    {
      "resourceType": "Patient",
      "id": "p1",
      "name": [
        {
          "use": "official",
          "family": "f1"
        }
      ],
      "contact": [
        {
          "name": { "family": "f2" }
        }
      ]
    }
  ],
  "tests": [
    {
      "title": "Union of names",
      "view": {
        "resource": "Patient",
        "select": [
          {
            "union": [
              {
                "forEach": "name",
                "column": [{ "path": "family" }]
              },
              {
                "forEach": "contact.name",
                "column": [{ "path": "family" }]
              }
            ]
          }
        ]
      },
      "expect": [{ "family": "f1" }, { "family": "f2" }]
    },
    {
      "title": "Union of names with top-level context",
      "view": {
        "resource": "Patient",
        "select": [
          {
            "column": [{ "path": "'x'", "alias": "common" }],
            "union": [
              {
                "forEach": "name",
                "column": [{ "path": "family" }]
              },
              {
                "forEach": "contact.name",
                "column": [{ "path": "family" }]
              }
            ]
          }
        ]
      },
      "expect": [
        { "common": "x", "family": "f1" },
        { "common": "x", "family": "f2" }
      ]
    }
  ]
}
